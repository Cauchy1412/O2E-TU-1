(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-36c00066"],{"1edb":function(t,e,n){"use strict";n("9827")},"30fc":function(t,e,n){"use strict";n("f5a9")},"72a6":function(t,e,n){"use strict";n("a9df")},9827:function(t,e,n){},a9df:function(t,e,n){},ac8f:function(t,e,n){"use strict";n.d(e,"l",(function(){return r})),n.d(e,"o",(function(){return o})),n.d(e,"n",(function(){return s})),n.d(e,"m",(function(){return c})),n.d(e,"h",(function(){return u})),n.d(e,"a",(function(){return l})),n.d(e,"i",(function(){return d})),n.d(e,"j",(function(){return m})),n.d(e,"d",(function(){return p})),n.d(e,"f",(function(){return f})),n.d(e,"e",(function(){return h})),n.d(e,"g",(function(){return g})),n.d(e,"k",(function(){return y})),n.d(e,"b",(function(){return v})),n.d(e,"c",(function(){return _}));n("1da1"),n("96cf"),n("99af");var i=n("7424"),a=n("b775");var r=function(t){var e="Interpretation",n="/api/".concat(e,"/getkeywords");return Object(a["f"])(n,"get",t)},o=function(t){var e="/api/recommend";return Object(a["f"])(e,"get",t)},s=function(t){var e="Interpretation",n="/api/".concat(e,"/getvis");return Object(a["f"])(n,"get",t)},c=function(t){var e="Interpretation",n="/api/".concat(e,"/gettags");return Object(a["f"])(n,"get",t)},u=function(t,e){var n="/api/comment";return Object(a["f"])(n,t,e)},l=function(t,e,n,i){var r=1===e?"Interpretation":"Note",o="/api/".concat(r,"/").concat(t);return Object(a["f"])(o,n,i)},d=function(t){if(null===t||void 0===t)return"无";var e=new Date(t),n=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds(),i=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),a=e.getHours()<10?"0"+e.getHours():e.getHours();return"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate()," ").concat(a,":").concat(i,":").concat(n)},m=function(t){return t?Object(a["f"])(i["PaperAll"],"get",{user_id:t}):Object(a["f"])(i["PaperAll"],"get")},p=function(t,e){var n="/api/comment/create";return Object(a["f"])(n,t,e)},f=function(t,e){var n="/api/comment/delete";return Object(a["f"])(n,t,e)},h=function(t){var e="/api/discussion/create";return Object(a["f"])(e,"post",t)},g=function(t,e){var n="/api/discussion/delete";return Object(a["f"])(n,t,e)},y=function(t){return t?Object(a["f"])(i["UserAll"],"get",{user_id:t}):Object(a["f"])(i["UserAll"],"get")},v=function(t){var e="/api/user/delete";return Object(a["f"])(e,"post",t)},_=function(t){var e="/api/user/changeinfo";return Object(a["f"])(e,"post",t)}},ad3a:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-card",{attrs:{bordered:!1}},[n("a-list",{attrs:{"item-layout":"vertical",size:"large",pagination:t.pagination,"data-source":t.listData},scopedSlots:t._u([{key:"renderItem",fn:function(e){return n("a-list-item",{key:"item.title"},[n("template",{slot:"actions"},[n("span",{on:{click:function(n){return t.handleShow(e.id,e.type)}}},[n("a-icon",{staticStyle:{"margin-right":"8px"},attrs:{type:"star-o"}}),t._v(" "+t._s(e.startext)+" ")],1),n("span",{on:{click:function(n){return t.handleShow(e.id,e.type)}}},[n("a-icon",{staticStyle:{"margin-right":"8px"},attrs:{type:"like-o"}}),t._v(" "+t._s(e.liketext)+" ")],1),n("span",{on:{click:function(n){return t.handleShow(e.id,e.type)}}},[n("a-icon",{staticStyle:{"margin-right":"8px"},attrs:{type:"message"}}),t._v(" "+t._s(e.messagetext)+" ")],1)]),n("a-space",{staticStyle:{"margin-right":"20px"},attrs:{slot:"extra",direction:"vertical",width:"272",align:"end"},slot:"extra"},[n("a-row",[n("a-col",{attrs:{span:24}},[n("a-button",{staticStyle:{width:"80px"},attrs:{type:"primary"},on:{click:function(n){return t.handleShow(e.id,e.type)}}},[t._v(" 查看 ")])],1)],1),n("a-row",[n("a-col",{attrs:{span:24}},[n("a-popconfirm",{attrs:{title:"确定要删除论文解读吗？","ok-text":"确定","cancel-text":"取消"},on:{confirm:function(n){return t.handleDelete(e.id,e.type)}}},[n("a-button",{staticStyle:{width:"80px"},attrs:{type:"danger"}},[t._v(" 删除")])],1)],1)],1)],1),n("a-Modal",{attrs:{title:"",width:"750px"},on:{ok:t.handleOk},model:{value:t.showDetail,callback:function(e){t.showDetail=e},expression:"showDetail"}},[t.showDetail?n("PaperCard",t._b({},"PaperCard",t.post,!1)):t._e()],1),n("a-list-item-meta",{attrs:{description:e.description}},[n("a",{attrs:{slot:"title",href:e.href},slot:"title"},[t._v(t._s(e.title))]),n("a-avatar",{attrs:{slot:"avatar",src:e.avatar},slot:"avatar"})],1),n("a",{staticStyle:{display:"block"},attrs:{href:"javascript:void(0)"},on:{click:function(n){return t.handleShow(e.id,e.type)}}},[n("editor",{domProps:{innerHTML:t._s(e.content)}})],1)],2)}}])})],1)],1)},a=[],r=n("1da1"),o=(n("96cf"),n("ac1f"),n("5319"),n("4d63"),n("25f0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor-wrapper"},[n("div",{attrs:{id:t.editorId}})])}),s=[];n("a9e3");function c(t,e){for(var n=0;n<e.length;n++)if(t===e[n])return!0;return!1}var u={name:"Editor",props:{value:{type:String,default:""},valueType:{type:String,default:"html",validator:function(t){return c(t,["html","text"])}},changeInterval:{type:Number,default:200},cache:{type:Boolean,default:!1}},computed:{editorId:function(){return"editor".concat(this._uid)}},methods:{setHtml:function(t){this.editor.txt.html(t)}}},l=u,d=(n("1edb"),n("2877")),m=Object(d["a"])(l,o,s,!1,null,null,null),p=m.exports,f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-card",{attrs:{bordered:!1,"dis-hover":""}},[n("div",{attrs:{slot:"title"},slot:"title"},[t._v(" 发布者: "),n("a",{attrs:{href:"javascript:0",id:t.id}},[t._v(t._s(""===t.creator["username"]?"未知用户":t.creator["username"]))])]),n("p",{attrs:{slot:"extra"},slot:"extra"},[t._v(" "+t._s(1===t.kind?"论文解读":"批注")+"发布于: "+t._s(t.createAt)+" ")]),n("a-Row",[t._v(" 解读对象: "),n("a",{attrs:{href:t.source}},[t._v(" "+t._s(t.citation)+" ")]),t._v("-------"+t._s(t.publishedYear)+"年 ")]),n("a-Row",[t._v(" 标题: "+t._s(t.title)+" ")]),n("br"),n("br"),n("br"),n("editor",{domProps:{innerHTML:t._s(t.content)}}),n("br"),n("a-Row",t._l(t.tags,(function(e,i){return n("a-Tag",{key:i,staticClass:"sysTopics"},[t._v(t._s(e.name))])})),1),n("br"),0===t.displayType?[n("a-space",[n("a-button",{staticStyle:{"font-size":"14px"},attrs:{href:"javascript:0"}},[n("a-Icon",{attrs:{type:"star-o"}}),t._v("收藏"+t._s(t.totalFavor)+" ")],1),n("a-button",{staticStyle:{"font-size":"14px"},attrs:{href:"javascript:0"}},[n("a-Icon",{attrs:{type:"like-o"}}),t._v("点赞 "+t._s(t.totalLike)+" ")],1),n("a-button",{staticStyle:{"font-size":"14px"},on:{click:t.onComment}},[n("a-Icon",{attrs:{type:"message"}}),t._v("评论 "+t._s(t.totalcomment)+" ")],1)],1),t.showComment?n("a-Card",{staticStyle:{"margin-top":"10px"}},[n("comment",t._b({},"comment",t.comments,!1))],1):t._e()]:t._e()],2)],1)},h=[],g=n("5530"),y=(n("d81d"),n("159b"),n("4de4"),n("07ac"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.comments,(function(e,i){return n("div",{key:i,staticClass:"author-title reply-father"},[n("a-Avatar",{staticClass:"header-img",attrs:{size:"default",src:e.headImg}}),n("div",{staticClass:"author-info"},[n("span",{staticClass:"author-name"},[t._v(t._s(e.name))]),n("span",{staticClass:"author-time"},[t._v(t._s(e.time))])]),n("div",{staticClass:"icon-btn"},[n("a-popconfirm",{attrs:{confirm:"",title:"确定要删除吗?删除后将不可恢复。"},on:{confirm:function(e){return t.deleteItem(i,t.reply)}}},[n("a-Button",[n("a-Icon",{attrs:{type:"delete"}}),t._v("删除 ")],1)],1),t._e()],1),n("div",{staticClass:"talk-box"},[n("p",[n("span",{staticClass:"reply"},[n("editor",{domProps:{innerHTML:t._s(e.comment)}})],1)])]),n("div",{staticClass:"reply-box"},t._l(e.reply,(function(e,a){return n("div",{key:a,staticClass:"author-title"},[n("a-Avatar",{staticClass:"header-img",attrs:{size:"default",src:e.headImg}}),n("div",{staticClass:"author-info"},[n("span",{staticClass:"author-name"},[t._v(t._s(e.name))]),n("span",{staticClass:"author-time"},[t._v(t._s(e.time))])]),n("div",{staticClass:"icon-btn"},[n("a-popconfirm",{attrs:{confirm:"",title:"确定要删除吗?删除后将不可恢复。"},on:{confirm:function(e){return t.deleteReply(i,a)}}},[n("a-Button",[n("a-icon",{attrs:{type:"delete"}}),t._v("删除 ")],1)],1)],1),n("div",{staticClass:"reply-box"})],1)})),0)],1)})),0)}),v=[],_=(n("a434"),n("ac8f")),b={bind:function(t,e){function n(n){if(t.contains(n.target))return!1;e.expression&&e.value(n)}t.vueClickOutside=n,document.addEventListener("click",n)},update:function(){},unbind:function(t){document.removeEventListener("click",t.vueClickOutside),delete t.vueClickOutside}},w={name:"ArticleComment",components:{editor:p},props:{myHeader:{type:String,default:"https://ae01.alicdn.com/kf/Hd60a3f7c06fd47ae85624badd32ce54dv.jpg"},myId:{type:Number,default:19870621},comments_init:{type:Array,default:function(){return[]}},interpretation_id:{type:Number,default:0},commentType:{type:Number,default:0}},data:function(){return{btnShow:!1,index:"0",replyComment:"",myName:"SUPERMANAGER",to:"",toId:-1,comments:this.comments_init}},directives:{clickoutside:b},methods:{inputFocus:function(){var t=document.getElementById("replyInput");t.style.padding="8px 8px",t.style.border="2px solid blue",t.focus()},showReplyBtn:function(){this.btnShow=!0},hideReplyBtn:function(){this.btnShow=!1},showReplyInput:function(t,e,n){this.comments[this.index].inputShow=!1,this.index=t,this.comments[t].inputShow=!0,this.to=e,this.toId=n},_inputShow:function(t){return this.comments[t].inputShow},deleteItem:function(t){var e=this,n=0===this.commentType?_["f"]:_["g"];n("post",{id:this.comments[t].commentId}).then((function(n){e.comments.splice(t,1),e.$message.success("删除成功！")})).catch((function(t){e.$message.success("删除失败!")}))},deleteReply:function(t,e){var n=this,i=0===this.commentType?_["f"]:_["g"];i("post",{id:this.comments[t].reply[e].commentId}).then((function(i){n.comments[t].reply.splice(e,1),n.$message.success("删除成功！")})).catch((function(t){n.$message.success("删除失败!")}))},sendComment:function(){var t=this;if(this.replyComment){var e={},n=document.getElementById("replyInput"),i=(new Date).getTime(),a=this.dateStr(i);e.name=this.myName,e.id=this.myId,e.comment=this.replyComment,e.headImg=this.myHeader,e.time=a,e.reply=[],e.commentNum=0,e.like=0,0===this.commentType?Object(_["d"])("post",{interpretation_id:this.interpretation_id,content:e.comment}).then((function(i){t.$message.success("评论成功!"),e.commentId=i.data.id,t.comments.push(e),t.replyComment="",n.innerHTML=""})).catch((function(e){t.$Message.error("评论失败!")})):Object(_["e"])({topic_id:this.interpretation_id,content:e.comment}).then((function(i){t.$Message.success("评论成功!"),e.commentId=i.data.id,t.comments.push(e),t.replyComment="",n.innerHTML=""})).catch((function(e){t.$Message.error("评论失败!")}))}else this.$message({showClose:!0,type:"warning",message:"评论不能为空"})},sendCommentReply:function(t){var e=this;if(this.replyComment){var n={},i=(new Date).getTime(),a=this.dateStr(i);n.name=this.myName,n.to=this.to,n.id=this.myId,n.headImg=this.myHeader,n.comment=this.replyComment,n.time=a,n.commentNum=0,n.like=0,0===this.commentType?Object(_["d"])("post",{interpretation_id:this.interpretation_id,content:n.comment,parent_comment_id:this.comments[t].commentId,to_user_id:this.toId}).then((function(i){e.$Message.success("评论成功!"),n.commentId=i.data.id,e.comments[t].reply.push(n),e.replyComment="",document.getElementsByClassName("reply-comment-input")[t].innerHTML=""})).catch((function(t){e.$Message.error("评论失败!")})):Object(_["e"])({topic_id:this.interpretation_id,content:n.comment,parent_discussion_id:this.comments[t].commentId,to_user_id:this.toId}).then((function(i){e.$Message.success("评论成功!"),n.commentId=i.data.id,e.comments[t].reply.push(n),e.replyComment="",document.getElementsByClassName("reply-comment-input")[t].innerHTML=""})).catch((function(t){e.$Message.error("评论失败!")}))}else this.$message({showClose:!0,type:"warning",message:"评论不能为空"})},onDivInput:function(t){this.replyComment=t.target.innerHTML},dateStr:function(t){var e,n=(new Date).getTime();return n=parseInt((n-t)/1e3),n<600?"刚刚":n<3600&&n>=600?(e=Math.floor(n/60),e+"分钟前"):n<86400&&n>=3600?(e=Math.floor(n/60/60),e+"小时前"):n<2592e3&&n>=86400?(e=Math.floor(n/60/60/24),e+"天前"):(t=new Date(parseInt(t)),t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate())}}},C=w,x=(n("72a6"),Object(d["a"])(C,y,v,!1,null,null,null)),k=x.exports,I={name:"PaperCard",components:{comment:k,Editor:p,editor:p},props:{id:{type:Number,default:0},creator:{type:Object,default:function(){return{username:"xx",id:"0"}}},title:{type:String,default:"引用"},kind:{type:Number,default:1},citeMessageInit:{type:String,default:"引用"},createAt:{type:String,default:"年/月/日"},content:{type:String,default:"这是一个展示示例"},tags:{type:Array,default:function(){return[]}},isLike:{type:Boolean,default:!1},isCollect:{type:Boolean,default:!1},likeNumber:{type:Number,default:0},favorNumber:{type:Number,default:0},commentNum:{type:Number,default:0},displayType:{type:Number,default:0},source:{type:String,default:"qq"},citation:{type:String,default:"ss"},publishedYear:{type:Number,default:0},interpretations:{type:Array,default:function(){return[]}}},data:function(){return{like:this.$props.isLike,totalLike:this.$props.likeNumber,totalcomment:this.$props.commentNum,totalFavor:this.$props.favorNumber,collect:this.$props.isCollect,cited:!1,showComment:!1,comments:[],detailController:!1,showUserControl:!1,userInfo:{},htmlTitle:this.title,followText:"",paperid:"1"}},computed:{likeColor:function(){return this.like?"#0084ff":"#747b8b"},paperId:function(){return this.paperid},collectType:function(){return this.collect?"ios-heart":"ios-heart-outline"},collectColor:function(){return this.collect?"#fb7299":"default"},citeStyle:function(){return this.cite?"margin-left:100px;":""},citeMessage:function(){return this.cited?"取消":this.citeMessageInit},popId:function(){return"pop"+this.$props.id}},methods:{onLike:function(){this.like=!1},onCollect:function(){this.collect=!1},onComment:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getComments();case 2:this.showComment=!this.showComment;case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),showDetail:function(){var t=this;0===this.evidences.length?Object(_["a"])(this.id,this.kind,"get").then((function(e){t.evidences=e.data.evidences,t.detailController=!0})).catch((function(t){})):this.detailController=!0},convertComments:function(t){t=t.map((function(t){return{commentId:t.id,name:t.username,time:Object(_["i"])(t.created_at),id:t.user_id,comment:t.text,to:t.to_user?t.to_user.username:0,toId:t.to_user?t.to_user.id:"",inputShow:!1,headImg:"https://file.iviewui.com/dist/a0e88e83800f138b94d2414621bd9704.png",parent_comment_id:t.parent_comment_id,reply:[]}}));var e={};return t.filter((function(t){return void 0===t.parent_comment_id})).forEach((function(t){e[t.commentId]=t})),t.forEach((function(t){void 0!==t.parent_comment_id&&e[t.parent_comment_id].reply.push(t)})),Object.values(e)},getComments:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,n,i,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e="SUPERMANAGER",n=1,i={myName:e,interpretation_id:this.id,myHeader:"https://file.iviewui.com/dist/a0e88e83800f138b94d2414621bd9704.png",myId:n},t.next=5,Object(_["h"])("get",{interpretation_id:this.id,pindex:1,psize:20}).then((function(t){a.comments=Object(g["a"])(Object(g["a"])({},i),{},{comments_init:a.convertComments(t.data.comment_list)})})).catch((function(t){a.comments=i}));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},S=I,j=Object(d["a"])(S,f,h,!1,null,null,null),O=j.exports,N=(n("99af"),n("b775")),T=n("7424");var M=function(t){return t?Object(N["f"])(T["PaperAll"],"get",{user_id:t}):Object(N["f"])(T["PaperAll"],"get")},$=function(t,e,n,i){var a=1===e?"Interpretation":"Note",r="/api/".concat(a,"/").concat(t);return Object(N["f"])(r,n,i)},R=[],E={name:"ArticleList",components:{PaperCard:O,editor:p},data:function(){return{loading:!0,pageIndex:1,data:[],totalCnt:1,showCutter:!1,post:{},interpretation:{},postType:0,InterpretationeType:0,postSelectType:"论文解读",projectTotalCnt:1,projectList:[],showDetail:!1,showModify:!1,listData:R,pagination:{onChange:function(t){},pageSize:10},actions:[{type:"star-o",text:""},{type:"like-o",text:""},{type:"message",text:""}],conjectureRule:{content:[{required:!0,message:"请填写内容",trigger:"blur"}]},evidenceRule:{content:[{required:!0,message:"请填写内容",trigger:"blur"}],citation:[{required:!0,message:"请填写参考文献",trigger:"blur"}],published_year:[{validator:function(t,e,n){e?n():n(new Error("请输入文献年份"))}}]},interpretationRule:{content:[{required:!0,message:"请填写内容",trigger:"blur"}],title:[{required:!0,message:"请填写标题",trigger:"blur"}],citation:[{required:!0,message:"请填写参考文献",trigger:"blur"}],published_year:[{validator:function(t,e,n){e?n():n(new Error("请输入文献年份"))}}]}}},mounted:function(){this.init()},methods:{ToText:function(t){var e=t;return e.replace(/<(style|script|iframe)[^>]*?>[\s\S]+?<\/\1\s*>/gi,"").replace(/<[^>]+?>/g,"").replace(/\s+/g," ").replace(/ /g," ").replace(/>/g," ")},init:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.loadPost();case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleShow:function(t,e){var n=this;$(t,e,"get").then((function(t){n.post={id:t.data.id,creator:t.data.created_by,kind:e,source:t.data.source,citation:t.data.citation,title:t.data.title,createAt:t.data.created_at,content:t.data.content,tags:t.data.tags,isLike:t.data.is_like,isCollect:t.data.is_favor,likeNumber:t.data.like_num,favorNumber:t.data.favor_num,commentNum:t.data.commentNum,publishedYear:t.data.published_year},n.postType=e,n.showDetail=!0})).catch((function(t){}))},handleOk:function(t){this.showDetail=!1},getSimpleText:function(t){var e=new RegExp("<.+?>","g"),n=t.replace(e,"");return n},loadPost:function(){var t=this;this.loading=!0,"论文解读"===this.postSelectType?M().then((function(e){var n="";R.length=0;for(var i=0;i<e.data.length;i++)n=e.data[i].content.replace(/<(style|script|iframe)[^>]*?>[\s\S]+?<\/\1\s*>/gi,"").replace(/<[^>]+?>/g,"").replace(/\s+/g," ").replace(/ /g," ").replace(/>/g," "),n.length>=200&&(n=n.substring(0,200)+"..."),t.actions=[{type:"star-o",text:e.data[i].favor_num},{type:"like-o",text:e.data[i].like_num},{type:"message",text:e.data[i].commentNum}],R.push({href:"javascript:0",title:e.data[i].title,avatar:" http://114.115.168.211:8000/api/"+e.data[i].userpic,description:e.data[i].created_by.username+"  |  "+e.data[i].created_at,content:n,startext:e.data[i].favor_num,liketext:e.data[i].like_num,messagetext:e.data[i].commentNum,id:e.data[i].id,type:1});t.totalCnt=e.data.total_count,t.loading=!1})).catch((function(t){})):this.loadProjects()},handleDelete:function(t,e){var n=this;$(t,e,"delete").then((function(t){n.pageIndex=1,n.loadPost(),n.$message.success("成功删除",3)})).catch((function(t){}))},handleModifyPost:function(t,e){var n=this;$(t,e,"get").then((function(t){n.post=t.data,n.postType=e,n.showModify=!0})).catch((function(t){}))},handleSubmit:function(t){var e=this;if("interpretation"==t){var n={title:this.post.title,content:this.post.content,citation:this.post.citation,source:this.post.source,published_year:this.post.published_year};$(this.post.id,this.postType,"put",n).then((function(t){e.$Message.info("成功修改"),e.pageIndex=1,e.loadPost()})).catch((function(t){}))}}}},A=E,D=(n("30fc"),Object(d["a"])(A,i,a,!1,null,"c37ea164",null));e["default"]=D.exports},f5a9:function(t,e,n){}}]);